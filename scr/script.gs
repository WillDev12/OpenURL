function openUrl(url) {var ss = SpreadsheetApp.getActiveSpreadsheet();var fm = FormApp.getActiveForm();var sla = SlidesApp.getActivePresentation();var doc = DocumentApp.getActiveDocument();if (ss != null && ss != undefined) {if (url == null) {throw Error("Missing URL");} else {var text = '<!DOCTYPE html><html><head><base target="_blank"><script>const url1 ="'+ url +'";const winRef = window.open(url1);winRef ? google.script.host.close() : window.alert("Allow popup to redirect you to "+url1) ;window.onload=function(){document.getElementById("url").href = url1;}</script></head><body>Kindly allow pop ups</br>Or <a id="url">Click here </a>to continue!!!</body></html>';var service = HtmlService.createHtmlOutput(text).setHeight(100).setWidth(200);SpreadsheetApp.getUi().showModalDialog(service, "Loading...");}} else if (fm != null && fm != undefined) {if (url == null) {throw Error("Missing URL");} else {var text = '<!DOCTYPE html><html><head><base target="_blank"><script>const url1 ="'+ url +'";const winRef = window.open(url1);winRef ? google.script.host.close() : window.alert("Allow popup to redirect you to "+url1) ;window.onload=function(){document.getElementById("url").href = url1;}</script></head><body>Kindly allow pop ups</br>Or <a id="url">Click here </a>to continue!!!</body></html>';var service = HtmlService.createHtmlOutput(text).setHeight(100).setWidth(200);FormApp.getUi().showModalDialog(service, "Loading...");}} else if (sla != null && sla != undefined) {if (url == null) {throw Error("Missing URL");} else {var text = '<!DOCTYPE html><html><head><base target="_blank"><script>const url1 ="'+ url +'";const winRef = window.open(url1);winRef ? google.script.host.close() : window.alert("Allow popup to redirect you to "+url1) ;window.onload=function(){document.getElementById("url").href = url1;}</script></head><body>Kindly allow pop ups</br>Or <a id="url">Click here </a>to continue!!!</body></html>';var service = HtmlService.createHtmlOutput(text).setHeight(100).setWidth(200);SlidesApp.getUi().showModalDialog(service, "Loading...");}} else if (doc != null && doc != undefined) {if (url == null) {throw Error("Missing URL");} else {var text = '<!DOCTYPE html><html><head><base target="_blank"><script>const url1 ="'+ url +'";const winRef = window.open(url1);winRef ? google.script.host.close() : window.alert("Allow popup to redirect you to "+url1) ;window.onload=function(){document.getElementById("url").href = url1;}</script></head><body>Kindly allow pop ups</br>Or <a id="url">Click here </a>to continue!!!</body></html>';var service = HtmlService.createHtmlOutput(text).setHeight(100).setWidth(200);DocumentApp.getUi().showModalDialog(service, "Loading...");}} else {throw Error("There is no active Sheet, Slideshow, Doc, or Form");}}
